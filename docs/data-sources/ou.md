---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "ad_ou Data Source - ad"
subcategory: ""
description: |-
  Retrieves information about an Active Directory organizational unit (OU). Supports multiple lookup methods: objectGUID, Distinguished Name, or name with parent path.
---

# ad_ou (Data Source)

Retrieves information about an Active Directory organizational unit (OU). Supports multiple lookup methods: objectGUID, Distinguished Name, or name with parent path.

## Example Usage

```terraform
# AD OU Data Source Example

terraform {
  required_providers {
    ad = {
      source = "isometry/ad"
    }
  }
}

provider "ad" {
  domain   = "example.com"
  username = "admin@example.com"
  password = "secure_password"
}

# Lookup OU by name
data "ad_ou" "departments" {
  name = "Departments"
}

# Lookup OU by Distinguished Name
data "ad_ou" "by_dn" {
  dn = "ou=IT Department,ou=Departments,dc=example,dc=com"
}

# Lookup OU by GUID
data "ad_ou" "by_guid" {
  id = "12345678-1234-5678-9012-123456789012"
}

# Lookup OU by path (alternative to DN)
data "ad_ou" "by_path" {
  path = "ou=Security Groups,ou=IT Department,ou=Departments,dc=example,dc=com"
}

# Use OU data to create resources in the correct container
resource "ad_group" "department_group" {
  name             = "IT Department Staff"
  sam_account_name = "ITStaff"
  container        = data.ad_ou.by_dn.dn
  scope            = "Global"
  category         = "Security"
  description      = "All IT Department staff members"
}

# Create nested OU structure based on existing OU
resource "ad_ou" "nested_ou" {
  name        = "Contractors"
  path        = data.ad_ou.by_dn.dn
  description = "Contractor accounts within ${data.ad_ou.by_dn.name}"
}

# Use OU information to organize resources
resource "ad_ou" "sub_departments" {
  for_each = toset([
    "Development",
    "Operations",
    "Support"
  ])

  name        = each.key
  path        = data.ad_ou.by_dn.dn
  description = "${each.key} team within ${data.ad_ou.by_dn.name}"
}

# Create groups for each sub-department
resource "ad_group" "sub_department_groups" {
  for_each = ad_ou.sub_departments

  name             = "${each.value.name} Team"
  sam_account_name = "${each.value.name}Team"
  container        = each.value.dn
  scope            = "Global"
  category         = "Security"
  description      = "Members of the ${each.value.name} team"
}

# Output OU information
output "ou_details" {
  value = {
    departments = {
      name        = data.ad_ou.departments.name
      dn          = data.ad_ou.departments.dn
      description = data.ad_ou.departments.description
      protected   = data.ad_ou.departments.protect_from_deletion
    }
    it_department = {
      name        = data.ad_ou.by_dn.name
      dn          = data.ad_ou.by_dn.dn
      description = data.ad_ou.by_dn.description
      protected   = data.ad_ou.by_dn.protect_from_deletion
    }
  }
}

output "created_structure" {
  value = {
    sub_departments = {
      for name, ou in ad_ou.sub_departments :
      name => {
        dn          = ou.dn
        description = ou.description
      }
    }
    groups = {
      for name, group in ad_group.sub_department_groups :
      name => {
        dn        = group.dn
        container = group.container
      }
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `dn` (String) The Distinguished Name of the OU to retrieve. Example: `OU=IT,OU=Departments,DC=example,DC=com`
- `id` (String) The objectGUID of the OU to retrieve. This is the most reliable lookup method as objectGUIDs are immutable and unique. Format: `550e8400-e29b-41d4-a716-446655440000`
- `name` (String) The name of the OU to retrieve. When using this lookup method, the `path` attribute must also be specified to identify the parent container. Example: `IT`
- `path` (String) The parent container DN where the OU is located. Required when using the `name` lookup method. Example: `OU=Departments,DC=example,DC=com`

### Read-Only

- `child_count` (Number) The total number of immediate child OUs.
- `children` (List of String) A list of Distinguished Names of all immediate child OUs.
- `description` (String) The description of the organizational unit.
- `parent` (String) The parent container DN of the OU.
- `protected` (Boolean) Whether the OU is protected from accidental deletion.
- `when_changed` (String) The timestamp when the OU was last modified (RFC3339 format).
- `when_created` (String) The timestamp when the OU was created (RFC3339 format).
